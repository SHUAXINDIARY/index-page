---
description: 项目构建和组件规范
alwaysApply: true
---

# 项目规范

## 技术栈

- **框架**: React 18
- **语言**: TypeScript 5
- **构建工具**: Rsbuild
- **包管理器**: pnpm

## 构建工具

本项目使用 **Rsbuild** 构建，相关文档参考：
- Rsbuild: https://rsbuild.rs/llms.txt
- Rspack: https://rspack.rs/llms.txt

## 常用命令

```bash
pnpm dev        # 启动开发服务器（自动打开浏览器）
pnpm dev:noopen # 启动开发服务器（不打开浏览器）
pnpm build      # 构建生产版本
pnpm preview    # 预览生产构建
pnpm lint       # 运行 ESLint 检查
pnpm format     # 使用 Prettier 格式化代码
```

## 组件结构

公共组件维护在 `src/components/` 目录，遵循以下规范：

```
src/components/
└── ComponentName/
    ├── ComponentName.tsx  # 组件实现
    ├── ComponentName.css  # 组件样式
    └── index.ts           # 导出入口
```

## 依赖库

| 库名 | 用途 | 文档 |
|------|------|------|
| lucide-react | 图标库 | https://lucide.dev/ |
| maplibre-gl | 地图渲染 | https://maplibre.org/maplibre-gl-js/docs/ |
| dayjs | 日期处理 | https://day.js.org/ |
| ical.js | iCal 日历解析 | https://github.com/kewisch/ical.js |
| motion | React 动画库 | https://motion.dev/docs/react |

## 文档

大功能迭代和更新，自动同步记录到根目录的 README.md 和 CHANGELOG.md 中

## 代码规范

### 异步代码

所有异步操作必须使用 `async/await` 语法：

```typescript
// ❌ BAD
function fetchData() {
  return fetch('/api/data')
    .then(res => res.json())
    .then(data => processData(data));
}

// ✅ GOOD
async function fetchData() {
  const res = await fetch('/api/data');
  const data = await res.json();
  return processData(data);
}
```

### 常量管理

常量逻辑抽离为独立变量，维护在当前文件最顶部（import 语句之后）：

```typescript
import { useState } from 'react';

// 常量定义区域
const DEFAULT_PAGE_SIZE = 10;
const API_TIMEOUT_MS = 5000;
const SUPPORTED_FORMATS = ['jpg', 'png', 'webp'];

// 组件/函数实现
export function MyComponent() {
  // ...
}
```

### 注释规范

所有逻辑变量和 TypeScript 类型都需要有注释：

```typescript
/** 用户信息类型 */
interface UserInfo {
  /** 用户唯一标识 */
  id: string;
  /** 用户显示名称 */
  name: string;
  /** 用户头像 URL */
  avatar?: string;
}

/** 当前页码，从 1 开始 */
const [page, setPage] = useState(1);

/** 是否正在加载数据 */
const [loading, setLoading] = useState(false);
```

## 代码质量工具

### ESLint

项目使用 ESLint 9 + TypeScript ESLint 进行代码检查，包含以下插件：
- `eslint-plugin-react-hooks`: React Hooks 规则检查
- `eslint-plugin-react-refresh`: React Fast Refresh 兼容性检查

### Prettier

使用 Prettier 进行代码格式化，提交前请运行 `pnpm format`

## 已安装的 Skills

请在处理相关任务时，启用并遵循以下已安装的 skills：

- **React Best Practices** (`.cursor/skills/vercel-react-best-practices/`): React/Next.js 性能优化指南